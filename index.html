<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>WebGIS Interaktif</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
        #map { height: 90vh; width: 100%; }
        .checkbox-list { padding: 10px;}
    </style>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- Leaflet Search Plugin (untuk pencarian lokasi) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
</head>
<body>

<div class="checkbox-list">
    <!-- Checkbox untuk layer data -->
    <label><input type="checkbox" id="cb_roads"> Roads</label>
    <label><input type="checkbox" id="cb_points"> Points</label>
    <label><input type="checkbox" id="cb_polygons"> Polygons</label>
</div>

<div id="map"></div>

<script>
// 1. Inisialisasi Map
var map = L.map('map').setView([-6.9, 107.6], 11);

// 2. Dua Basemap
var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

var satellite = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',{
    attribution: '&copy; Satellite layer'
});

// 3. Kontrol basemap
var baseMaps = {
    "OpenStreetMap": osm,
    "Satellite": satellite
};
L.control.layers(baseMaps).addTo(map);

// 4. Layer kosong untuk file-file data
var layerRoads = L.layerGroup().addTo(map);
var layerPoints = L.layerGroup().addTo(map);
var layerPolygons = L.layerGroup().addTo(map);

// 5. Load data GeoJSON
function loadGeoJSON(url, layerGroup){
    fetch(url)
    .then(res => res.json())
    .then(data => L.geoJSON(data).addTo(layerGroup));
}

// 6. Checkbox toggles
document.getElementById('cb_roads').addEventListener('change', function() {
    if(this.checked) {
        loadGeoJSON('data/roads.geojson', layerRoads);
    } else {
        map.removeLayer(layerRoads);
        layerRoads.clearLayers();
    }
});
document.getElementById('cb_points').addEventListener('change', function() {
    if(this.checked) {
        loadGeoJSON('data/points.geojson', layerPoints);
    } else {
        map.removeLayer(layerPoints);
        layerPoints.clearLayers();
    }
});
document.getElementById('cb_polygons').addEventListener('change', function() {
    if(this.checked) {
        loadGeoJSON('data/polygons.geojson', layerPolygons);
    } else {
        map.removeLayer(layerPolygons);
        layerPolygons.clearLayers();
    }
});

// 7. Search control (Leaflet Geocoder)
L.Control.geocoder({
    defaultMarkGeocode: true
}).addTo(map);

</script>
</body>
</html>
